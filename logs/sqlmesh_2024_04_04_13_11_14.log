2024-04-04 13:11:14,848 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for data files: {'db.db'} (connection.py:255)
2024-04-04 13:11:14,877 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for in-memory database (connection.py:257)
2024-04-04 13:11:14,947 - MainThread - sqlmesh.core.config.connection - INFO - Using existing DuckDB adapter due to overlapping data file: db.db (connection.py:250)
2024-04-04 13:11:21,015 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema db.sqlmesh__sqlmesh_example (evaluator.py:258)
2024-04-04 13:11:21,016 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:1822)
2024-04-04 13:11:21,018 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:1822)
2024-04-04 13:11:21,019 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM information_schema.tables WHERE table_schema = 'sqlmesh__sqlmesh_example' AND table_name IN ('sqlmesh_example__seed_model__1248844913', 'sqlmesh_example__incremental_model__3269816977', 'sqlmesh_example__full_model__3031530868', 'sqlmesh_example__full_model__3031530868__temp', 'sqlmesh_example__seed_model__1248844913__temp', 'sqlmesh_example__incremental_model__3269816977__temp') (base.py:1822)
2024-04-04 13:11:21,055 - MainThread - sqlmesh.core.state_sync.common - INFO - Promoting environment 'prod' (common.py:120)
2024-04-04 13:11:21,073 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Altering table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__full_model__3031530868' (evaluator.py:1126)
2024-04-04 13:11:21,073 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__3031530868" (base.py:1822)
2024-04-04 13:11:21,074 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__3031530868__temp" (base.py:1822)
2024-04-04 13:11:21,080 - MainThread - sqlmesh.core.state_sync.common - INFO - Pausing snapshot SnapshotId<"db"."sqlmesh_example"."full_model": 2828824763> (common.py:246)
2024-04-04 13:11:21,082 - MainThread - sqlmesh.core.state_sync.common - INFO - Unpausing snapshot SnapshotId<"db"."sqlmesh_example"."full_model": 1313860788> (common.py:225)
2024-04-04 13:11:21,083 - MainThread - sqlmesh.core.state_sync.common - INFO - Unpausing snapshot SnapshotId<"db"."sqlmesh_example"."incremental_model": 3167203313> (common.py:225)
2024-04-04 13:11:21,087 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'db.sqlmesh_example' (evaluator.py:809)
2024-04-04 13:11:21,087 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "db"."sqlmesh_example" (base.py:1822)
2024-04-04 13:11:21,088 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'db.sqlmesh_example.incremental_model' to point at table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__incremental_model__3269816977' (evaluator.py:1041)
2024-04-04 13:11:21,088 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "db"."sqlmesh_example"."incremental_model" AS SELECT * FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model__3269816977" (base.py:1822)
2024-04-04 13:11:21,089 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'db.sqlmesh_example.full_model' to point at table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__full_model__3031530868' (evaluator.py:1041)
2024-04-04 13:11:21,090 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "db"."sqlmesh_example"."full_model" AS SELECT * FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__3031530868" (base.py:1822)
2024-04-04 13:11:21,090 - MainThread - sqlmesh.core.state_sync.common - INFO - Finalizing environment 'Environment<snapshots: [SnapshotTableInfo<name: "db"."sqlmesh_example"."seed_model", change_category: 1, fingerprint: SnapshotFingerprint<2682453022, data: 1220485773, meta: 3675754436, pdata: 0, pmeta: 0>, version: 1248844913, physical_schema_: sqlmesh__sqlmesh_example, parents: (), kind_name: SEED>, SnapshotTableInfo<name: "db"."sqlmesh_example"."full_model", temp_version: 3031530868, change_category: 5, fingerprint: SnapshotFingerprint<1313860788, data: 2650841478, meta: 2825355689, pdata: 3170397133, pmeta: 1768871832>, previous_versions: (SnapshotDataVersion<fingerprint: SnapshotFingerprint<2828824763, data: 2650841478, meta: 1700024854, pdata: 4025707506, pmeta: 276518137>, version: 3031530868, change_category: 1, physical_schema_: sqlmesh__sqlmesh_example>,), version: 3031530868, physical_schema_: sqlmesh__sqlmesh_example, parents: (SnapshotId<"db"."sqlmesh_example"."incremental_model": 3167203313>,), kind_name: FULL>, SnapshotTableInfo<name: "db"."sqlmesh_example"."incremental_model", change_category: 2, fingerprint: SnapshotFingerprint<3167203313, data: 4139297552, meta: 4016643932, pdata: 1870762845, pmeta: 3629104689>, previous_versions: (SnapshotDataVersion<fingerprint: SnapshotFingerprint<1146462437, data: 4029270082, meta: 418654361, pdata: 1870762845, pmeta: 3629104689>, version: 141311533, change_category: 1, physical_schema_: sqlmesh__sqlmesh_example>,), version: 3269816977, physical_schema_: sqlmesh__sqlmesh_example, parents: (SnapshotId<"db"."sqlmesh_example"."seed_model": 2682453022>,), kind_name: INCREMENTAL_BY_TIME_RANGE>], start_at: 2020-01-01 00:00:00+00:00, end_at: 1712188800000, plan_id: e933075f2c6449d3910144906cc91aa5, previous_plan_id: b8e5e5bc54f1493e9633fd7d1b88f10f, previous_finalized_snapshots: [SnapshotTableInfo<name: "db"."sqlmesh_example"."full_model", change_category: 1, fingerprint: SnapshotFingerprint<2828824763, data: 2650841478, meta: 1700024854, pdata: 4025707506, pmeta: 276518137>, version: 3031530868, physical_schema_: sqlmesh__sqlmesh_example, parents: (SnapshotId<"db"."sqlmesh_example"."incremental_model": 1146462437>,), kind_name: FULL>, SnapshotTableInfo<name: "db"."sqlmesh_example"."incremental_model", change_category: 1, fingerprint: SnapshotFingerprint<1146462437, data: 4029270082, meta: 418654361, pdata: 1870762845, pmeta: 3629104689>, version: 141311533, physical_schema_: sqlmesh__sqlmesh_example, parents: (SnapshotId<"db"."sqlmesh_example"."seed_model": 2682453022>,), kind_name: INCREMENTAL_BY_TIME_RANGE>, SnapshotTableInfo<name: "db"."sqlmesh_example"."seed_model", change_category: 1, fingerprint: SnapshotFingerprint<2682453022, data: 1220485773, meta: 3675754436, pdata: 0, pmeta: 0>, version: 1248844913, physical_schema_: sqlmesh__sqlmesh_example, parents: (), kind_name: SEED>]>' (common.py:198)
