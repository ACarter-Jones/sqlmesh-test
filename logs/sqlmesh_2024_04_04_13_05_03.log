2024-04-04 13:05:03,947 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for data files: {'db.db'} (connection.py:255)
2024-04-04 13:05:03,974 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for in-memory database (connection.py:257)
2024-04-04 13:05:04,063 - MainThread - sqlmesh.core.config.connection - INFO - Using existing DuckDB adapter due to overlapping data file: db.db (connection.py:250)
2024-04-04 13:05:04,082 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0001_init' from '/Users/A.Carter-Jones/Documents/.env/lib/python3.8/site-packages/sqlmesh/migrations/v0001_init.py'> (engine_adapter.py:919)
2024-04-04 13:05:04,096 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0002_remove_identify' from '/Users/A.Carter-Jones/Documents/.env/lib/python3.8/site-packages/sqlmesh/migrations/v0002_remove_identify.py'> (engine_adapter.py:919)
2024-04-04 13:05:04,096 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0003_move_batch_size' from '/Users/A.Carter-Jones/Documents/.env/lib/python3.8/site-packages/sqlmesh/migrations/v0003_move_batch_size.py'> (engine_adapter.py:919)
2024-04-04 13:05:04,096 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0004_environmnent_add_finalized_at' from '/Users/A.Carter-Jones/Documents/.env/lib/python3.8/site-packages/sqlmesh/migrations/v0004_environmnent_add_finalized_at.py'> (engine_adapter.py:919)
2024-04-04 13:05:04,097 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0005_create_seed_table' from '/Users/A.Carter-Jones/Documents/.env/lib/python3.8/site-packages/sqlmesh/migrations/v0005_create_seed_table.py'> (engine_adapter.py:919)
2024-04-04 13:05:04,097 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0006_change_seed_hash' from '/Users/A.Carter-Jones/Documents/.env/lib/python3.8/site-packages/sqlmesh/migrations/v0006_change_seed_hash.py'> (engine_adapter.py:919)
2024-04-04 13:05:04,097 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0007_env_table_info_to_kind' from '/Users/A.Carter-Jones/Documents/.env/lib/python3.8/site-packages/sqlmesh/migrations/v0007_env_table_info_to_kind.py'> (engine_adapter.py:919)
2024-04-04 13:05:04,098 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0008_create_intervals_table' from '/Users/A.Carter-Jones/Documents/.env/lib/python3.8/site-packages/sqlmesh/migrations/v0008_create_intervals_table.py'> (engine_adapter.py:919)
2024-04-04 13:05:04,099 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0009_remove_pre_post_hooks' from '/Users/A.Carter-Jones/Documents/.env/lib/python3.8/site-packages/sqlmesh/migrations/v0009_remove_pre_post_hooks.py'> (engine_adapter.py:919)
2024-04-04 13:05:04,099 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0010_seed_hash_batch_size' from '/Users/A.Carter-Jones/Documents/.env/lib/python3.8/site-packages/sqlmesh/migrations/v0010_seed_hash_batch_size.py'> (engine_adapter.py:919)
2024-04-04 13:05:04,099 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0011_add_model_kind_name' from '/Users/A.Carter-Jones/Documents/.env/lib/python3.8/site-packages/sqlmesh/migrations/v0011_add_model_kind_name.py'> (engine_adapter.py:919)
2024-04-04 13:05:04,100 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0012_update_jinja_expressions' from '/Users/A.Carter-Jones/Documents/.env/lib/python3.8/site-packages/sqlmesh/migrations/v0012_update_jinja_expressions.py'> (engine_adapter.py:919)
2024-04-04 13:05:04,101 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0013_serde_using_model_dialects' from '/Users/A.Carter-Jones/Documents/.env/lib/python3.8/site-packages/sqlmesh/migrations/v0013_serde_using_model_dialects.py'> (engine_adapter.py:919)
2024-04-04 13:05:04,102 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0014_fix_dev_intervals' from '/Users/A.Carter-Jones/Documents/.env/lib/python3.8/site-packages/sqlmesh/migrations/v0014_fix_dev_intervals.py'> (engine_adapter.py:919)
2024-04-04 13:05:04,102 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0015_environment_add_promoted_snapshot_ids' from '/Users/A.Carter-Jones/Documents/.env/lib/python3.8/site-packages/sqlmesh/migrations/v0015_environment_add_promoted_snapshot_ids.py'> (engine_adapter.py:919)
2024-04-04 13:05:04,102 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0016_fix_windows_path' from '/Users/A.Carter-Jones/Documents/.env/lib/python3.8/site-packages/sqlmesh/migrations/v0016_fix_windows_path.py'> (engine_adapter.py:919)
2024-04-04 13:05:04,103 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0017_fix_windows_seed_path' from '/Users/A.Carter-Jones/Documents/.env/lib/python3.8/site-packages/sqlmesh/migrations/v0017_fix_windows_seed_path.py'> (engine_adapter.py:919)
2024-04-04 13:05:04,103 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0018_rename_snapshot_model_to_node' from '/Users/A.Carter-Jones/Documents/.env/lib/python3.8/site-packages/sqlmesh/migrations/v0018_rename_snapshot_model_to_node.py'> (engine_adapter.py:919)
2024-04-04 13:05:04,104 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0019_add_env_suffix_target' from '/Users/A.Carter-Jones/Documents/.env/lib/python3.8/site-packages/sqlmesh/migrations/v0019_add_env_suffix_target.py'> (engine_adapter.py:919)
2024-04-04 13:05:04,105 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0020_remove_redundant_attributes_from_dbt_models' from '/Users/A.Carter-Jones/Documents/.env/lib/python3.8/site-packages/sqlmesh/migrations/v0020_remove_redundant_attributes_from_dbt_models.py'> (engine_adapter.py:919)
2024-04-04 13:05:04,105 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0021_fix_table_properties' from '/Users/A.Carter-Jones/Documents/.env/lib/python3.8/site-packages/sqlmesh/migrations/v0021_fix_table_properties.py'> (engine_adapter.py:919)
2024-04-04 13:05:04,106 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0022_move_project_to_model' from '/Users/A.Carter-Jones/Documents/.env/lib/python3.8/site-packages/sqlmesh/migrations/v0022_move_project_to_model.py'> (engine_adapter.py:919)
2024-04-04 13:05:04,107 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0023_fix_added_models_with_forward_only_parents' from '/Users/A.Carter-Jones/Documents/.env/lib/python3.8/site-packages/sqlmesh/migrations/v0023_fix_added_models_with_forward_only_parents.py'> (engine_adapter.py:919)
2024-04-04 13:05:04,107 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0024_replace_model_kind_name_enum_with_value' from '/Users/A.Carter-Jones/Documents/.env/lib/python3.8/site-packages/sqlmesh/migrations/v0024_replace_model_kind_name_enum_with_value.py'> (engine_adapter.py:919)
2024-04-04 13:05:04,108 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0025_fix_intervals_and_missing_change_category' from '/Users/A.Carter-Jones/Documents/.env/lib/python3.8/site-packages/sqlmesh/migrations/v0025_fix_intervals_and_missing_change_category.py'> (engine_adapter.py:919)
2024-04-04 13:05:04,108 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0026_remove_dialect_from_seed' from '/Users/A.Carter-Jones/Documents/.env/lib/python3.8/site-packages/sqlmesh/migrations/v0026_remove_dialect_from_seed.py'> (engine_adapter.py:919)
2024-04-04 13:05:04,109 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0027_minute_interval_to_five' from '/Users/A.Carter-Jones/Documents/.env/lib/python3.8/site-packages/sqlmesh/migrations/v0027_minute_interval_to_five.py'> (engine_adapter.py:919)
2024-04-04 13:05:04,109 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0028_add_plan_dags_table' from '/Users/A.Carter-Jones/Documents/.env/lib/python3.8/site-packages/sqlmesh/migrations/v0028_add_plan_dags_table.py'> (engine_adapter.py:919)
2024-04-04 13:05:04,110 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0029_generate_schema_types_using_dialect' from '/Users/A.Carter-Jones/Documents/.env/lib/python3.8/site-packages/sqlmesh/migrations/v0029_generate_schema_types_using_dialect.py'> (engine_adapter.py:919)
2024-04-04 13:05:04,110 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0030_update_unrestorable_snapshots' from '/Users/A.Carter-Jones/Documents/.env/lib/python3.8/site-packages/sqlmesh/migrations/v0030_update_unrestorable_snapshots.py'> (engine_adapter.py:919)
2024-04-04 13:05:04,111 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0031_remove_dbt_target_fields' from '/Users/A.Carter-Jones/Documents/.env/lib/python3.8/site-packages/sqlmesh/migrations/v0031_remove_dbt_target_fields.py'> (engine_adapter.py:919)
2024-04-04 13:05:04,111 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0032_add_sqlmesh_version' from '/Users/A.Carter-Jones/Documents/.env/lib/python3.8/site-packages/sqlmesh/migrations/v0032_add_sqlmesh_version.py'> (engine_adapter.py:919)
2024-04-04 13:05:04,112 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0033_mysql_fix_blob_text_type' from '/Users/A.Carter-Jones/Documents/.env/lib/python3.8/site-packages/sqlmesh/migrations/v0033_mysql_fix_blob_text_type.py'> (engine_adapter.py:919)
2024-04-04 13:05:04,112 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0034_add_default_catalog' from '/Users/A.Carter-Jones/Documents/.env/lib/python3.8/site-packages/sqlmesh/migrations/v0034_add_default_catalog.py'> (engine_adapter.py:919)
2024-04-04 13:05:04,114 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0035_add_catalog_name_override' from '/Users/A.Carter-Jones/Documents/.env/lib/python3.8/site-packages/sqlmesh/migrations/v0035_add_catalog_name_override.py'> (engine_adapter.py:919)
2024-04-04 13:05:04,114 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0036_delete_plan_dags_bug_fix' from '/Users/A.Carter-Jones/Documents/.env/lib/python3.8/site-packages/sqlmesh/migrations/v0036_delete_plan_dags_bug_fix.py'> (engine_adapter.py:919)
2024-04-04 13:05:04,114 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0037_remove_dbt_is_incremental_macro' from '/Users/A.Carter-Jones/Documents/.env/lib/python3.8/site-packages/sqlmesh/migrations/v0037_remove_dbt_is_incremental_macro.py'> (engine_adapter.py:919)
2024-04-04 13:05:04,115 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0038_add_expiration_ts_to_snapshot' from '/Users/A.Carter-Jones/Documents/.env/lib/python3.8/site-packages/sqlmesh/migrations/v0038_add_expiration_ts_to_snapshot.py'> (engine_adapter.py:919)
2024-04-04 13:05:04,116 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0039_include_environment_in_plan_dag_spec' from '/Users/A.Carter-Jones/Documents/.env/lib/python3.8/site-packages/sqlmesh/migrations/v0039_include_environment_in_plan_dag_spec.py'> (engine_adapter.py:919)
2024-04-04 13:05:04,116 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0040_add_previous_finalized_snapshots' from '/Users/A.Carter-Jones/Documents/.env/lib/python3.8/site-packages/sqlmesh/migrations/v0040_add_previous_finalized_snapshots.py'> (engine_adapter.py:919)
2024-04-04 13:05:04,116 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0041_remove_hash_raw_query_attribute' from '/Users/A.Carter-Jones/Documents/.env/lib/python3.8/site-packages/sqlmesh/migrations/v0041_remove_hash_raw_query_attribute.py'> (engine_adapter.py:919)
2024-04-04 13:05:04,117 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0042_trim_indirect_versions' from '/Users/A.Carter-Jones/Documents/.env/lib/python3.8/site-packages/sqlmesh/migrations/v0042_trim_indirect_versions.py'> (engine_adapter.py:919)
2024-04-04 13:05:04,117 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0043_fix_remove_obsolete_attributes_in_plan_dags' from '/Users/A.Carter-Jones/Documents/.env/lib/python3.8/site-packages/sqlmesh/migrations/v0043_fix_remove_obsolete_attributes_in_plan_dags.py'> (engine_adapter.py:919)
2024-04-04 13:05:04,118 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Applying migration <module 'sqlmesh.migrations.v0044_quote_identifiers_in_model_attributes' from '/Users/A.Carter-Jones/Documents/.env/lib/python3.8/site-packages/sqlmesh/migrations/v0044_quote_identifiers_in_model_attributes.py'> (engine_adapter.py:919)
2024-04-04 13:05:04,118 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Fetching environments (engine_adapter.py:978)
2024-04-04 13:05:04,118 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Migrating snapshot rows... (engine_adapter.py:996)
2024-04-04 13:05:04,119 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - No changes to snapshots detected (engine_adapter.py:988)
2024-04-04 13:05:29,535 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema db.sqlmesh__sqlmesh_example (evaluator.py:258)
2024-04-04 13:05:29,535 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:1822)
2024-04-04 13:05:29,536 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:1822)
2024-04-04 13:05:29,538 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM information_schema.tables WHERE table_schema = 'sqlmesh__sqlmesh_example' AND table_name IN ('sqlmesh_example__seed_model__1248844913__temp', 'sqlmesh_example__full_model__3031530868', 'sqlmesh_example__full_model__3031530868__temp', 'sqlmesh_example__incremental_model__141311533__temp', 'sqlmesh_example__seed_model__1248844913', 'sqlmesh_example__incremental_model__141311533') (base.py:1822)
2024-04-04 13:05:29,546 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'db.sqlmesh__sqlmesh_example' (evaluator.py:809)
2024-04-04 13:05:29,546 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "db"."sqlmesh__sqlmesh_example" (base.py:1822)
2024-04-04 13:05:29,548 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__seed_model__1248844913__temp' (evaluator.py:1083)
2024-04-04 13:05:29,549 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__seed_model__1248844913__temp" ("id" INT, "item_id" INT, "event_date" DATE) (base.py:1822)
2024-04-04 13:05:29,550 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__seed_model__1248844913' (evaluator.py:1083)
2024-04-04 13:05:29,550 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__seed_model__1248844913" ("id" INT, "item_id" INT, "event_date" DATE) (base.py:1822)
2024-04-04 13:05:29,559 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__incremental_model__141311533__temp' (evaluator.py:1083)
2024-04-04 13:05:29,559 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model__141311533__temp" ("id" INT, "item_id" INT, "event_date" DATE) (base.py:1822)
2024-04-04 13:05:29,560 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Dry running model 'sqlmesh_example.incremental_model' (evaluator.py:1103)
2024-04-04 13:05:29,560 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT "seed_model"."id" AS "id", "seed_model"."item_id" AS "item_id", "seed_model"."event_date" AS "event_date" FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__seed_model__1248844913" AS "seed_model" WHERE ("seed_model"."event_date" <= CAST('1970-01-01' AS DATE) AND "seed_model"."event_date" >= CAST('1970-01-01' AS DATE)) AND FALSE LIMIT 0 (base.py:1822)
2024-04-04 13:05:29,562 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__incremental_model__141311533' (evaluator.py:1083)
2024-04-04 13:05:29,563 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model__141311533" ("id" INT, "item_id" INT, "event_date" DATE) (base.py:1822)
2024-04-04 13:05:29,568 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__full_model__3031530868__temp' (evaluator.py:1083)
2024-04-04 13:05:29,568 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__3031530868__temp" ("item_id" INT, "num_orders" BIGINT) (base.py:1822)
2024-04-04 13:05:29,569 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Dry running model 'sqlmesh_example.full_model' (evaluator.py:1103)
2024-04-04 13:05:29,569 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT "incremental_model"."item_id" AS "item_id", COUNT(DISTINCT "incremental_model"."id") AS "num_orders" FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model__141311533" AS "incremental_model" WHERE FALSE GROUP BY "incremental_model"."item_id" LIMIT 0 (base.py:1822)
2024-04-04 13:05:29,571 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__full_model__3031530868' (evaluator.py:1083)
2024-04-04 13:05:29,571 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__3031530868" ("item_id" INT, "num_orders" BIGINT) (base.py:1822)
2024-04-04 13:05:29,592 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"db"."sqlmesh_example"."seed_model": 2682453022> (evaluator.py:464)
2024-04-04 13:05:29,594 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2024-04-03 00:00:00+00:00, 2024-04-04 00:00:00+00:00) into db.sqlmesh__sqlmesh_example.sqlmesh_example__seed_model__1248844913' (evaluator.py:488)
2024-04-04 13:05:29,596 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE TABLE "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__seed_model__1248844913" AS SELECT "id", "item_id", "event_date" FROM "db"."sqlmesh__sqlmesh_example"."__temp_sqlmesh_example__seed_model__1248844913_p18e2nc5" (base.py:1822)
2024-04-04 13:05:29,597 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DROP TABLE IF EXISTS "db"."sqlmesh__sqlmesh_example"."__temp_sqlmesh_example__seed_model__1248844913_p18e2nc5" (base.py:1822)
2024-04-04 13:05:29,598 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Adding interval (1712102400000, 1712188800000) for snapshot SnapshotId<"db"."sqlmesh_example"."seed_model": 2682453022> (engine_adapter.py:631)
2024-04-04 13:05:29,604 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"db"."sqlmesh_example"."incremental_model": 1146462437> (evaluator.py:464)
2024-04-04 13:05:29,608 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2020-01-01 00:00:00+00:00, 2024-04-04 00:00:00+00:00) into db.sqlmesh__sqlmesh_example.sqlmesh_example__incremental_model__141311533' (evaluator.py:488)
2024-04-04 13:05:29,609 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DELETE FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model__141311533" WHERE "event_date" BETWEEN CAST('2020-01-01' AS DATE) AND CAST('2024-04-03' AS DATE) (base.py:1822)
2024-04-04 13:05:29,610 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: INSERT INTO "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model__141311533" ("id", "item_id", "event_date") SELECT "id", "item_id", "event_date" FROM (SELECT "seed_model"."id" AS "id", "seed_model"."item_id" AS "item_id", "seed_model"."event_date" AS "event_date" FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__seed_model__1248844913" AS "seed_model" WHERE "seed_model"."event_date" <= CAST('2024-04-03' AS DATE) AND "seed_model"."event_date" >= CAST('2020-01-01' AS DATE)) AS "_subquery" WHERE "event_date" BETWEEN CAST('2020-01-01' AS DATE) AND CAST('2024-04-03' AS DATE) (base.py:1822)
2024-04-04 13:05:29,611 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Adding interval (1577836800000, 1712188800000) for snapshot SnapshotId<"db"."sqlmesh_example"."incremental_model": 1146462437> (engine_adapter.py:631)
2024-04-04 13:05:29,618 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"db"."sqlmesh_example"."full_model": 2828824763> (evaluator.py:464)
2024-04-04 13:05:29,620 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2020-01-01 00:00:00+00:00, 2024-04-04 00:00:00+00:00) into db.sqlmesh__sqlmesh_example.sqlmesh_example__full_model__3031530868' (evaluator.py:488)
2024-04-04 13:05:29,621 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE TABLE "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__3031530868" AS SELECT "incremental_model"."item_id" AS "item_id", COUNT(DISTINCT "incremental_model"."id") AS "num_orders" FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model__141311533" AS "incremental_model" GROUP BY "incremental_model"."item_id" (base.py:1822)
2024-04-04 13:05:29,623 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Auditing snapshot SnapshotId<"db"."sqlmesh_example"."full_model": 2828824763> (evaluator.py:386)
2024-04-04 13:05:29,623 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__3031530868" (base.py:1822)
2024-04-04 13:05:29,626 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM (SELECT * FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__3031530868" AS "sqlmesh_example__full_model__3031530868") AS "_q_0" WHERE "item_id" < 0) AS "audit" (base.py:1822)
2024-04-04 13:05:29,626 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Adding interval (1577836800000, 1712188800000) for snapshot SnapshotId<"db"."sqlmesh_example"."full_model": 2828824763> (engine_adapter.py:631)
2024-04-04 13:05:29,634 - MainThread - sqlmesh.core.state_sync.common - INFO - Promoting environment 'prod' (common.py:120)
2024-04-04 13:05:29,647 - MainThread - sqlmesh.core.state_sync.common - INFO - Unpausing snapshot SnapshotId<"db"."sqlmesh_example"."seed_model": 2682453022> (common.py:225)
2024-04-04 13:05:29,649 - MainThread - sqlmesh.core.state_sync.common - INFO - Unpausing snapshot SnapshotId<"db"."sqlmesh_example"."full_model": 2828824763> (common.py:225)
2024-04-04 13:05:29,651 - MainThread - sqlmesh.core.state_sync.common - INFO - Unpausing snapshot SnapshotId<"db"."sqlmesh_example"."incremental_model": 1146462437> (common.py:225)
2024-04-04 13:05:29,656 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'db.sqlmesh_example' (evaluator.py:809)
2024-04-04 13:05:29,656 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "db"."sqlmesh_example" (base.py:1822)
2024-04-04 13:05:29,656 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'db.sqlmesh_example.seed_model' to point at table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__seed_model__1248844913' (evaluator.py:1041)
2024-04-04 13:05:29,657 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "db"."sqlmesh_example"."seed_model" AS SELECT * FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__seed_model__1248844913" (base.py:1822)
2024-04-04 13:05:29,658 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'db.sqlmesh_example.incremental_model' to point at table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__incremental_model__141311533' (evaluator.py:1041)
2024-04-04 13:05:29,658 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "db"."sqlmesh_example"."incremental_model" AS SELECT * FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model__141311533" (base.py:1822)
2024-04-04 13:05:29,659 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'db.sqlmesh_example.full_model' to point at table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__full_model__3031530868' (evaluator.py:1041)
2024-04-04 13:05:29,659 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "db"."sqlmesh_example"."full_model" AS SELECT * FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__3031530868" (base.py:1822)
2024-04-04 13:05:29,660 - MainThread - sqlmesh.core.state_sync.common - INFO - Finalizing environment 'Environment<snapshots: [SnapshotTableInfo<name: "db"."sqlmesh_example"."seed_model", change_category: 1, fingerprint: SnapshotFingerprint<2682453022, data: 1220485773, meta: 3675754436, pdata: 0, pmeta: 0>, version: 1248844913, physical_schema_: sqlmesh__sqlmesh_example, parents: (), kind_name: SEED>, SnapshotTableInfo<name: "db"."sqlmesh_example"."full_model", change_category: 1, fingerprint: SnapshotFingerprint<2828824763, data: 2650841478, meta: 1700024854, pdata: 4025707506, pmeta: 276518137>, version: 3031530868, physical_schema_: sqlmesh__sqlmesh_example, parents: (SnapshotId<"db"."sqlmesh_example"."incremental_model": 1146462437>,), kind_name: FULL>, SnapshotTableInfo<name: "db"."sqlmesh_example"."incremental_model", change_category: 1, fingerprint: SnapshotFingerprint<1146462437, data: 4029270082, meta: 418654361, pdata: 1870762845, pmeta: 3629104689>, version: 141311533, physical_schema_: sqlmesh__sqlmesh_example, parents: (SnapshotId<"db"."sqlmesh_example"."seed_model": 2682453022>,), kind_name: INCREMENTAL_BY_TIME_RANGE>], start_at: 2020-01-01 00:00:00+00:00, plan_id: b8e5e5bc54f1493e9633fd7d1b88f10f, previous_finalized_snapshots: []>' (common.py:198)
