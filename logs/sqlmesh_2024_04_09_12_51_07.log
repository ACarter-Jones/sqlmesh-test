2024-04-09 12:51:07,623 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for data files: {'db.db'} (connection.py:255)
2024-04-09 12:51:07,651 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for in-memory database (connection.py:257)
2024-04-09 12:51:07,701 - MainThread - sqlmesh.core.config.connection - INFO - Using existing DuckDB adapter due to overlapping data file: db.db (connection.py:250)
2024-04-09 12:51:07,714 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Compacting 0 intervals for 0 snapshots (engine_adapter.py:679)
2024-04-09 12:51:07,743 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"db"."sqlmesh_example"."incremental_model": 3167203313> (evaluator.py:464)
2024-04-09 12:51:07,749 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2024-04-04 00:00:00+00:00, 2024-04-09 00:00:00+00:00) into db.sqlmesh__sqlmesh_example.sqlmesh_example__incremental_model__3269816977' (evaluator.py:488)
2024-04-09 12:51:07,752 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DELETE FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model__3269816977" WHERE "event_date" BETWEEN CAST('2024-04-04' AS DATE) AND CAST('2024-04-08' AS DATE) (base.py:1822)
2024-04-09 12:51:07,754 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: INSERT INTO "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model__3269816977" ("id", "item_id", "new_column", "event_date") SELECT "id", "item_id", "new_column", "event_date" FROM (SELECT "seed_model"."id" AS "id", "seed_model"."item_id" AS "item_id", 'z' AS "new_column", "seed_model"."event_date" AS "event_date" FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__seed_model__1248844913" AS "seed_model" WHERE "seed_model"."event_date" <= CAST('2024-04-08' AS DATE) AND "seed_model"."event_date" >= CAST('2024-04-04' AS DATE)) AS "_subquery" WHERE "event_date" BETWEEN CAST('2024-04-04' AS DATE) AND CAST('2024-04-08' AS DATE) (base.py:1822)
2024-04-09 12:51:07,755 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Adding interval (1712188800000, 1712620800000) for snapshot SnapshotId<"db"."sqlmesh_example"."incremental_model": 3167203313> (engine_adapter.py:631)
2024-04-09 12:51:07,767 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"db"."sqlmesh_example"."full_model": 1313860788> (evaluator.py:464)
2024-04-09 12:51:07,770 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2024-04-04 00:00:00+00:00, 2024-04-09 00:00:00+00:00) into db.sqlmesh__sqlmesh_example.sqlmesh_example__full_model__3031530868' (evaluator.py:488)
2024-04-09 12:51:07,772 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE TABLE "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__3031530868" AS SELECT "incremental_model"."item_id" AS "item_id", COUNT(DISTINCT "incremental_model"."id") AS "num_orders" FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model__3269816977" AS "incremental_model" GROUP BY "incremental_model"."item_id" (base.py:1822)
2024-04-09 12:51:07,774 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Auditing snapshot SnapshotId<"db"."sqlmesh_example"."full_model": 1313860788> (evaluator.py:386)
2024-04-09 12:51:07,774 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__3031530868" (base.py:1822)
2024-04-09 12:51:07,777 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM (SELECT * FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__3031530868" AS "sqlmesh_example__full_model__3031530868") AS "_q_0" WHERE "item_id" < 0) AS "audit" (base.py:1822)
2024-04-09 12:51:07,778 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Adding interval (1712188800000, 1712620800000) for snapshot SnapshotId<"db"."sqlmesh_example"."full_model": 1313860788> (engine_adapter.py:631)
